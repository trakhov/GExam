
\parindent = 0pt

\usepackage{fancyhdr} 
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}

\newlength{\miniH}\setlength{\miniH}{98.7mm}
\newlength{\miniL}\setlength{\miniL}{188mm}
\newlength{\logoW}\setlength{\logoW}{35mm}

\newcounter{bilet}

\newcommand{\bak}{Направление}
\newcommand{\spec}{}
\newcommand{\disc}{}
\newcommand{\kaf}{}
\newcommand{\protocol}{\rlfill}
\newcommand{\logo}{logo_new_psk} 
\newcommand{\teacherName}{}
\newcommand{\zavkafName}{} 
\newcommand{\specType}{} 


\DeclareDocumentCommand \insertItem { m } { \item #1 }

\DeclareDocumentCommand \insertParZ { m } 
{ 
	\paragraph{Задание \the\paragraph} #1
}


\DeclareDocumentCommand \Etop { O{Экзаменационный билет} } 
{
	\begin{center}	
  	\parbox[b]{\logoW}{\centering\includegraphics[width=2cm]{\logo}}%
  	\parbox[b]{\miniL - \logoW}{
  		\begin{tabularx}{\miniL - \logoW}{@{} X p{12cm} @{}}
  			\bak:					& \spec \\
  			Дисциплина:  	& \disc \\
	  		\multicolumn{2}{@{} l}{Утверждено заседанием кафедры \kaf\ от \protocol}
  		\end{tabularx}\bigskip

			\parbox[t]{\widthof{Преподаватель: \rlfill}}{
				Преподаватель: \rlfill\\\teacherName
			}\hspace{2cm}%
			\parbox[t]{\widthof{Зав. кафедрой: \rlfill}}{
				Зав. кафедрой: \rlfill\\\zavkafName
			}\vfill
  	}\medskip

    {\large\textbf{\textsc{#1 №\thebilet}}

    }	
  \end{center}
} 


\DeclareDocumentEnvironment {GEtop} { s O{Экзаменационный билет} } 
{
	{\small\centering
		Министерство образования и науки РФ
		Филиал федерального государственного бюджетного образовательного учреждения высшего образования

		<<Санкт-Петербургский государственный экономический университет>> в г. Пскове
		\smallskip

		\normalsize Государственный экзамен 
			\IfBooleanTF {#1} {по специальности} {по направлению}

		\spec\ <<\spectitle>> \specType

		\normalsize\the\year\ г.\medskip

		\large\textbf{\textsc{#2 №\thebilet}}\normalsize

	}
}
{
	{\centering
		Директор филиала \rlfill\ А. М. Алексеева

  }
}



\DeclareDocumentCommand \ExamCard 
{ O{Экзаменационный билет} +D//{} > { \SplitList {;;} } m } 
{	
	\begin{minipage}[b][\miniH][t]{\miniL}			
	\vspace{.7cm}\addtocounter{bilet}{1}
  \Etop[#1]
  #2
  \begin{enumerate}{ \ProcessList {#3} { \insertItem } }\end{enumerate}	
	\end{minipage}
}



\DeclareDocumentCommand \GExamCard 
{ s O{Экзаменационный билет} > {\SplitList {;;} } m } 
{%
	\addtocounter{bilet}{1}%
	\begin{minipage}[b][\miniH][t]{\miniL}%
	\vspace{7mm}
	\IfBooleanTF {#1} {\begin{GEtop}*[#2]} {\begin{GEtop}[#2]}
	  \begin{flushleft}
		  \begin{enumerate}{ \ProcessList {#3} { \insertItem } }\end{enumerate}	
	  \end{flushleft}
	  \vfill
	\end{GEtop}	
  \vspace{7mm}
	\end{minipage}
}






\DeclareDocumentCommand \teacher { m } 
{
	\IfNoValueTF {#1} {} {
		\renewcommand{\teacherName}{
			\centering({\footnotesize #1})
		}
	}
}

\DeclareDocumentCommand \zavkaf { m } 
{
	\IfNoValueTF {#1} {} {
		\renewcommand{\zavkafName}{
			\centering({\footnotesize #1})
		}
	}
}



\DeclareDocumentCommand \spectype { m } 
{
	\IfNoValueTF {#1} {} {
		% \renewcommand{\specType}{\\[-2pt]{\small(специализация «#1»)}}
		\renewcommand{\specType}{(<<#1>>)} 
	}
} 


\DeclareDocumentCommand \rlfill { O{28mm} } 
{
	\makebox[#1]{\hrulefill}
}


\newcommand{\spectitle}{}






\DeclareDocumentCommand \smallGE { s m m o } 
{
	\begin{center}\Large\bfseries
		Государственный экзамен
		\IfBooleanTF {#1} {по специальности} {по направлению}\\ 
		#2 <<#3>>
		\IfNoValueTF {#4} {} {\\[-1mm]{\normalsize(специализация <<#4>>)}}

	\end{center}
}





\DeclareDocumentCommand \lowGE { s O{А. М. Алексеева} O{5mm} } {
	\IfBooleanTF {#1} {\bigskip} {\vfill}
	\makebox{Директор филиала\hspace{#3}}
	\makebox[5cm]{\hrulefill}
	\makebox{\hspace{#3} #2 }
	\IfBooleanTF {#1} {
		\begin{tikzpicture}
			\draw[white] (0, 0) -- (0, -1);
			\draw[dashed] (0, -1) -- +(\textwidth, 0);			
		\end{tikzpicture}
	} {}
}









\DeclareDocumentCommand \signatures { 
    O{trakhov} O{.33} m m O{ivanov} O{.33} m m
} {%
	\foreach \x/\y/\name/\scale in {#3/#4/#1/#2, #7/#8/#5/#6} 
	\node at (\x, \z-\y) {\includegraphics[scale=\scale]{sign_\name}};
}

